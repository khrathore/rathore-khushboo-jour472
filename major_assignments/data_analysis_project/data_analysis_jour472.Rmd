---
title: "Data Analysis Project"
author: "Caroline Koutsos, Khushboo Rathore"
date: "28 April 2023"
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
library(tidyverse)
library(lubridate)
library(janitor)
library(dplyr)
library(ggplot2)
library(corrr)
```

## Load and Cleaning Data

```{r}
### LOAD AND CLEAN DATA ###

wsoccer_matchstat_2020 <- read_csv("data/ncaa_womens_soccer_matchstats_2020.csv", guess_max = 5000)
wsoccer_matchstat_2021 <- read_csv("data/ncaa_womens_soccer_matchstats_2021.csv", guess_max = 5000)
wsoccer_matchstat_2022 <- read_csv("data/ncaa_womens_soccer_matchstats_2022.csv", guess_max = 5000)

wsoccer_playerstat_2020 <- read_csv("data/ncaa_womens_soccer_playerstats_2020.csv", guess_max = 5000)
wsoccer_playerstat_2021 <- read_csv("data/ncaa_womens_soccer_playerstats_2021.csv", guess_max = 5000)
wsoccer_playerstat_2022 <- read_csv("data/ncaa_womens_soccer_playerstats_2022.csv", guess_max = 5000)

wsoccer_teams_2020 <- read_csv("url_csvs/NCAA Women's Soccer - 2020.csv") %>% 
  clean_names()
wsoccer_teams_2021 <- read_csv("url_csvs/NCAA Women's Soccer - 2021.csv") %>% 
  clean_names()
wsoccer_teams_2022 <- read_csv("url_csvs/NCAA Women's Soccer - 2022.csv") %>% 
  clean_names()

# Find the column names, create a key
col_names <- colnames(wsoccer_matchstat_2020)
# Data Dictionary: https://docs.google.com/spreadsheets/d/1lnEauTJ62LcCfWJdwIHUitD6Hai_-1YCDVsEbwiTSG8/edit#gid=0

# Clean 2020 match data so that we can rbind()
match_20 <- wsoccer_matchstat_2020 %>% 
  mutate(season = 2020) %>% 
  select(-points, -na.x, -na.y, -defensive_points)

# Clean 2021 match data so that we can rbind()
match_21 <- wsoccer_matchstat_2021 %>% 
  mutate(season = 2021) %>% 
  select(-gwg, -defensive_gwg)

# Clean 2022 match data so that we can rbind()
match_22 <- wsoccer_matchstat_2022 %>% 
  mutate(season = 2022) %>% 
  select(-gwg, -defensive_gwg)
  
# All matches across all three seasons
match_all <- match_20 %>% 
  rbind(match_21, match_22) %>% 
  mutate(ha_number = case_when(
    home_away == "Home"~ 0,
    home_away == "Away"~ 1,
    TRUE ~ NA
  ))

# Clean 2021 team data so that we can rbind()
teams_21 <- wsoccer_teams_2021 %>% 
  select(-so_g, -gwg, -games)

# Clean 2022 team data so that we can rbind()
teams_22 <- wsoccer_teams_2022 %>% 
  select(-so_g, -gwg, -games)

# Clean 2020 team data so that we can rbind()
cols_20 <- names(wsoccer_teams_2020)

teams_20 <- wsoccer_teams_2020 %>% 
  select(url, institution, conference, goals, assists, -points, sh_att, fouls, red_cards, yellow_cards, gc, goal_app, ggs, goalie_min_plyd, ga, saves, shutouts, combined_sho, g_wins, g_loss, d_saves, corners, pk, pk_att)

# Clean 2020 player data so that we can rbind()
players_20 <- wsoccer_playerstat_2020 %>% 
  select(season, team, jersey, full_name, roster_name, first_name, last_name, yr, pos, gp, gs, goals, assists, points, sh_att, fouls, red_cards, yellow_cards, gc, goal_app, ggs, goalie_min_plyd, ga, gaa, saves, sv_pct, combined_sho, shutouts, g_wins, g_loss, d_saves, corners, pk, pk_att, gwg)

# Clean 2021 player data so that we can rbind()
players_21 <- wsoccer_playerstat_2021 %>% 
  select(-so_g, -games)

# Clean 2022 player data so that we can rbind()
players_22 <- wsoccer_playerstat_2022 %>% 
  select(-so_g, -games)

# All players across three seasons
players_all <- players_20 %>% 
  rbind(players_21, players_22)

# All teams across three seasons
all_teams <- teams_20 %>% 
 rbind(teams_21, teams_22)
```

# Question One:
General comparison of performance at Home vs Away games:
  Do teams get more shutouts at Home games?
  Do players get carded more at Away games?
  Does being at a foreign field impact wins and losses aka W/L ratios?

# Answer:

Our analysis seems to indicate that teams have a significant advantage at home games. There was a significant difference in win percent, shutouts, and yellow cards for each team between home and away games. However, there was not a significant difference in the number of fouls usually given in home vs away games. It would be interesting to continue this by looking at difference in referees and if there tend to be stricter refs in certain conferences or at certain universities which could contribute to the cards. It would also be interesting to look at home and away with the additional context of a different field surface (actual grass vs turf, etc.)

In noticing that teams have a significant advantage at home, does this contribute to the importance of the “win on the road” mentality? Also, does this very among different sports or does it remain the same across sports, collegiate and professional? with the number of fouls given not being significant, does the “fouls” include only yellow and red cards or anytime the player gets a foul without a card? Also, it would be interesting to see if the number of set pieces contributes to wins as well, because there is a phrase in women’s soccer: “games are won or lost on setpieces”. If we were to do this again, maybe we could see the amount of free kicks, corner kicks, and pks that led to a goal or win. 

Overall, further analysis of this would probably be the most newsworthy. While the difference in overall performance isn't very new, understanding the reasons behind these changes could help teams and change the understanding of the sport.

``` {r}

## We'll be talking on Tuesday about correlations - which share some similarities with t-tests - and I think those could be useful for you in determining how important those home field advantages are. You also could do some multiple regression to see if a combination of factors add up to a meaningful relationship (https://www.thescoop.org/sports/multipleregression.html). 

matches_wld <- match_all %>% 
  # Group games by home/away and win-loss-draw for each team
  group_by(team, home_away, outcome) %>% 
  count() %>% 
  pivot_wider(names_from = outcome, values_from = n) %>% 
  replace(is.na(.), 0) %>% 
  # Create a column that has the Win-Loss-Draw ratio for the teams across all seasons
  mutate(wld_ratio = paste0(Win, "-", Loss, "-",Draw)) %>% 
  # Create a column that shows the win percentage for home vs away games across all seasons
  mutate(win_percent = Win/(Win+Loss+Draw)*100)

matches_compares <- match_all %>% 
  # Assign a numeric value to each outcome
  mutate(outcome = case_when(
    str_detect(outcome,"Loss")~0,
    str_detect(outcome,"Win")~1,
    str_detect(outcome,"Draw")~.5,
    TRUE~NA
  )) %>% 
  group_by(team, home_away, ha_number) %>% 
  # Create summary statistics for a variety of 
  summarize(
    w_l_d = mean(outcome),
    shutouts = sum(shutouts),
    all_red = sum(red_cards),
    all_yellow = sum(yellow_cards),
    foul_mean = mean(fouls),
    foul_median = median(fouls),
    score_mean = mean(team_score),
    score_med = median(team_score),
    goal_rate = sum(goals)/sum(sh_att),
  ) %>% 
  left_join(matches_wld, by = c("team", "home_away"))

# Boxplots that show wins, yellow cards, and mean of fouls 
boxplot(matches_compares$win_percent ~ matches_compares$home_away)
boxplot(matches_compares$all_yellow ~ matches_compares$home_away)
boxplot(matches_compares$foul_mean ~ matches_compares$home_away)


# Separate dataframes into data by home and away games
teams_home <- matches_compares %>% 
  filter(home_away == "Home")

teams_away <- matches_compares %>% 
  filter(home_away == "Away")

# T-Test to see home and away differences.
t.test(teams_home$win_percent, teams_away$win_percent, paired=TRUE)
t.test(teams_home$shutouts, teams_away$shutouts, paired=TRUE)
t.test(teams_home$all_yellow, teams_away$all_yellow, paired=TRUE)
t.test(teams_home$foul_mean, teams_away$foul_mean, paired=TRUE)

# Look at correlations for some variables, including home/away, win percent, goal rate, mean fouls, and mean score
matches_compares %>% 
  select(ha_number, win_percent, goal_rate, foul_mean, score_mean) %>% 
  correlate()

# Look at a linear regression for win percent by home/away, goal rate and score mean. 
summary(lm(matches_compares$win_percent ~ matches_compares$ha_number + matches_compares$goal_rate + matches_compares$score_mean))

```
# Question Two:

Do more popular numbers (attacking players) (10, 11, 9, 7) equate to more goals scored per season?

We wanted to pivot our question 2 because after a lengthy and fruitful discussion, we realized that I was basing my "popular numbers in soccer" on the men's side of soccer, particularly professional. To be honest, culturally, the men's and women's side of soccer are slightly different. So based on (my) experience in women's soccer since I was 3 years old, I would understand how the more popular numbers would be different depending on gender. Also, more men watch professional men's soccer (I'm assuming) - Caroline

# Question Two Revised:

Is there a significant relationship in performance and jersey number? Why are certain numbers more popular and which numbers have the best performance? Why do players choose the numbers that they do?

# Answer: 

When we take the widest look at the data by jersey numbers, we see a huge drop from 160 players to only 80 between the 35th and 36th most popular number. The most popular number that does well 

```{r}

# Your work here left me wondering what the distribution is like for all numbers - in other words, whether your choice of popular numbers (23, for example, doesn't seem to be massively popular compared to some others). I'd encourage you to start broad and then narrow down your focus based on your findings and theories.

player_dist <- players_all %>% 
  distinct(roster_name, .keep_all = TRUE)

nongk_player_by_jersey <- player_dist %>% 
  filter(!str_detect(pos, "GK")) %>% 
  group_by(jersey) %>% 
  summarize(
    num_players = n(),
    mean_goals = mean(goals, na.rm = TRUE),
    median_goals = median(goals, na.rm = TRUE),
    mean_gwg = mean(gwg, na.rm = TRUE),
    mean_shtrat = mean((goals/sh_att)*100, na.rm = TRUE),
    mean_gp = mean(gp, na.rm = TRUE),
    mean_fouls = mean(fouls, na.rm = TRUE)
  )

# Specifically collect statistics for any players who have jersey numbers 10, 11, 9, 7, and 23.
player_filter <- players_all %>% 
  filter(jersey == 10| jersey == 11| jersey == 9| jersey == 7| jersey == 23) %>% 
  select(-full_name, -points, -red_cards:-corners)

# Look at the statistics for players outside of those jersey numbers
player_anti <- players_all %>% 
  filter(!(jersey == 10| jersey == 11| jersey == 9| jersey == 7| jersey == 23)) %>% 
  select(-full_name, -points, -red_cards:-corners)

# Get some statistics for each jersey number we like
jersey_players <- player_filter %>% 
  # Asked Chat GPT: "How do I replace the NA values in every numeric column in a R dataframe with 0?"
  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>% 
  group_by(jersey) %>%
  summarize(
    mean_gp = mean(gp),
    mean_goals = mean(goals),
    median_goals = median(goals),
    goal_shtrat = sum(goals)/sum(sh_att)*100,
    mean_fouls = mean(fouls),
    pk_success = sum(pk)/sum(pk_att)*100,
    gwg = mean(gwg)
  )

# Get statistics for all other jersey numbers
other_players <- player_anti %>% 
  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>% 
  group_by(jersey) %>%
  summarize(
    mean_gp = mean(gp),
    mean_goals = mean(goals),
    median_goals = median(goals),
    goal_shtrat = sum(goals)/sum(sh_att)*100,
    mean_fouls = mean(fouls),
    pk_success = sum(pk)/sum(pk_att)*100,
    gwg = mean(gwg)
  )

# Create a chart that shows which 
jersey_chart <- nongk_player_by_jersey %>% 
  ggplot(aes(x = num_players, y = mean_goals)) +
  geom_point(size = 1, shape = 1, color = "black") + 
  labs(
    title = "Higher Jersey Numbers Are More of a Threat Near Goal",
    x = "Number of Players",
    y = "Mean Goals"
  )

jersey_chart

player_zero <- player_dist %>% 
  filter(jersey == 0)
```

# Question 3:

Upperclassmen vs Underclassmen: what years typically dominate the starting lineup in different conferences

# Answer:

If the logic of this code is correct, which we would like a second set of eyes on, it seems like the highest performing conferences had majority seniors. However, the AAC has a relatively even distribution in their players. Only one conference had more than half of their freshman playing, but they are made up of non-conference teams (it's weird).


```{r}

games_per_seasonteam <- match_all %>% 
  group_by(season, team) %>% 
  count()

team_unique <- all_teams %>%
  group_by(institution, conference) %>% 
  summarize(
    avg_goals = round(mean(goals),2),
    avg_shutouts = round(mean(shutouts),2),
    avg_fouls = round(mean(fouls),2)
  ) %>% 
  distinct(institution, .keep_all = TRUE)

regex_unis <- regex(paste(unique(all_teams$institution), collapse = "|"))

player_team <- players_all %>% 
  mutate(institution = str_extract(team, regex_unis)) %>% 
  mutate(institution = case_when(
    str_detect(team, "LMU \\(CA\\)")~"LMU (CA)",
    str_detect(team, "Miami \\(FL\\)")~"Miami (FL)",
    str_detect(team, "Miami \\(OH\\)")~"Miami (OH)",
    str_detect(team, "Queens \\(NC\\)")~"Queens (NC)",
    str_detect(team, "Saint Francis \\(PA\\)")~"Saint Francis (PA)",
    str_detect(team, "Saint Mary's \\(CA\\)")~"Saint Mary's (CA)",
    str_detect(team, "St. John's \\(NY\\)")~"St. John's (NY)",
    str_detect(team, "St. Thomas \\(MN\\)")~"St. Thomas (MN)",
    str_detect(team, "FDU")~"Fairleigh Dickinson",
    TRUE~institution
  )) %>% 
  select(season:gs, institution, -pos, -full_name) %>%
  left_join(games_per_seasonteam, by = c("season", "team")) %>% 
  left_join(team_unique, by = "institution") %>% 
  rename(season_games = n)


player_by_year <- player_team %>% 
  group_by(roster_name, institution, yr, conference, season) %>% 
  summarize(
    percent_start = round(gs/season_games*100,2)
  ) %>% 
  mutate(percent_start = case_when(
    is.na(percent_start)~0,
    TRUE~percent_start
  ))
  
institution_year <- player_team %>%
  group_by(roster_name, institution, yr, conference, season) %>% 
  summarize(
    percent_start = round(gs/season_games*100,2)
  ) %>% 
  mutate(percent_start = case_when(
    is.na(percent_start)~0,
    TRUE~percent_start
  )) %>% 
  group_by(institution, conference, yr) %>% 
  summarize(
    starter = mean(percent_start)
  ) %>% 
  pivot_wider(names_from = "yr", values_from = "starter") %>% 
  select(institution, conference, Fr, So, Jr, Sr) %>% 
  left_join(team_unique, by = c("institution", "conference"))

start_play <- player_team %>% 
  group_by(roster_name, institution, yr, conference, season) %>% 
  summarize(
    start_play = round(gs/gp*100,2)
  ) %>% 
  mutate(start_play = case_when(
    is.na(start_play)~0,
    TRUE~start_play
  )) %>% 
  group_by(institution, conference, yr) %>% 
  summarize(
    starter = mean(start_play)
  ) %>% 
  pivot_wider(names_from = "yr", values_from = "starter") %>% 
  select(institution, conference, Fr, So, Jr, Sr) %>% 
  left_join(team_unique, by = c("institution", "conference"))

conference_stats <- institution_year %>% 
  group_by(conference) %>% 
  summarize(
    fr_se = round(mean(Fr),2),
    so_se = round(mean(So),2),
    jr_se = round(mean(Jr),2),
    sr_se = round(mean(Sr),2),
    mean_goals = round(mean(avg_goals),2),
    mean_foul = round(mean(avg_fouls),2)
  )

conference_startplay <- start_play %>% 
  group_by(conference) %>% 
  summarize(
    fr_sp = round(mean(Fr),2),
    so_sp = round(mean(So),2),
    jr_sp = round(mean(Jr),2),
    sr_sp = round(mean(Sr),2),
    mean_goals = round(mean(avg_goals),2),
    mean_foul = round(mean(avg_fouls),2)
  )

comp_eligible_played <- conference_stats %>% 
  left_join(conference_startplay, by = c("conference", "mean_goals", "mean_foul")) %>% 
  mutate(fr_dif = fr_sp - fr_se) %>% 
  mutate(so_dif = so_sp - so_se) %>% 
  mutate(jr_dif = jr_sp - jr_se) %>% 
  mutate(sr_dif = sr_sp - sr_se) %>% 
  select(conference, contains("dif"), contains("mean"))

```

# Question 4:

Team with the most shutouts vs team with most goals scored: which team is more successful on avg? Does the strength of an offense or defense impact match result more?

# Answer:

For the team that has the most shutouts versus goals scored, it would be interesting to see if it depends on how the goal is scored. Though we don’t have access to that information, we think it would be so cool to get data on whether it is a defensive error (which could be up to interpretation) or a true well orchestrated attack that leads to a goal. Though some goals could fall in both categories, we think that that could affect how one looks at the “goal scored” category. 

It looks like goals may matter more, but it's hard to separate teams with most goals and shutouts because they tend to be a similar list.

```{r}
# I think another way of asking this question could be this: "Do teams that record the most shutouts really need to do so because they are not high-scoring teams?" As you've found there are plenty of high-scoring teams that record shutouts; are there low-scoring teams that do the same consistently? Would speak to style of play.

team_wld <- match_all %>% 
  # Group games by home/away and win-loss-draw for each team
  group_by(team, outcome) %>% 
  count() %>% 
  pivot_wider(names_from = outcome, values_from = n) %>% 
  replace(is.na(.), 0) %>% 
  # Create a column that has the Win-Loss-Draw ratio for the teams across all seasons
  mutate(wld_ratio = paste0(Win, "-", Loss, "-",Draw)) %>% 
  # Create a column that shows the win percentage for home vs away games across all seasons
  mutate(win_percent = Win/(Win+Loss+Draw)*100)

matches_od <- match_all %>%
  group_by(team) %>% 
  summarize(
    tot_shut = sum(shutouts),
    avg_shut = mean(shutouts),
    tot_goals = sum(goals),
    avg_goals = mean(goals)
  ) %>% 
  left_join(team_wld, by = "team")

hist(matches_od$win_percent ~ matches_od$avg_goals)
  
top_shut <- matches_od %>% 
  arrange(desc(avg_shut)) %>% 
  head(100)
  
top_goals <- matches_od %>% 
  arrange(desc(avg_goals)) %>% 
  head(100)

boxplot(top_shut$win_percent)
boxplot(top_goals$win_percent)

# team_goals <- team_unique %>%
  
```


# Question 5:

Success rate of different types of mascots: (animals, mythical creatures, humans, etc.)?

# Answer: 

ANIMAL: (golden, purple, screaming) eagles, (runnin', lady) bulldogs, wildcats, falcons, zips, (lady) hornets, (lady) tigers, (lady) panthers, (lady) lions, razorbacks, cougars, cardinals, bruins, broncos, terriers, bison(s), bulls, roadrunners, mustangs, lancers, camels, mocs, chanticleers, buffaloes, rams, bluejays, (blue) hens, hornets, stags, owls, gators, hoya*, lopes (antelopes), Rainbow Wahine, (christian) huskies, (lady) jaguars, bengals, redbirds, Hoosiers, gaels, dolphins,	Gamecocks, JMU dukes, kangaroos, Roos, sharks, golden flashes, LMU (CA) Lions, leopards, greyhounds, Red Foxes, Thundering Herd, Terrapins (terps), golden gophers, (golden) grizzlies, lobos, aggies, tar heels, ospreys, bobcats, sooners, monarchs, mavericks, ducks, beavers, nittany lions, Mastodons, spiders, broncs, Peacocks, jackrabbits, coyotes, Salukis, Bonnies, tommies, horned frogs, longhorns, anteaters, retrievers, utes, beacons, catamounts, hokies, leathernecks, badgers, great danes, penguins

MYTHICAL: (sun, blue) devils, titans, (golden) griffins, (blue, lady) demons, demon deacons, dragons, phoenix, devilettes, Billikens, blazers, tritons

PEOPLE: governors, (lady) braves, mountaineers, (black, FDU, Scarlet) knights, matadors, chippewas, buccaneers, 49ers, vikings, (blue, red) raiders, flyers, pioneers, duquesne dukes*, (lady) pirates, islanders, colonels, seminoles, paladins, colonials, crusaders, vandals, explorers, trojans, Lady Techsters, jaspers, minutewomen, cowgirls, warriors, spartans, racers, highlanders, midshipmen, cornhuskers, huskers, lumberjacks, norse, fighting irish, (lady) rebels, quakers, pilots, friars, boilermakers, royals, Ladyjacks, Aztecs, Toreros, Dons, Saints, Hatters, Texas, Volunteers, cadets, gauchos, miners, vaqueros, trailblazers, VMI cadets, commodores, cavaliers, musketeers

NATURE: crimson tide, cyclones, Sycamores, (lady) flame, beach, hurricanes, buckeyes, waves, red storm, orange, golden hurricane, flames

MISC: big red, big green, purple aces, crimson, pride, Fighting Illini, Ragin' Cajuns, Ramblers, mean green, blue hose, the Red Flash, rockets, lady topper, tribe

Based on the mascot question, we had a feeling that the mascot with the most success would be an animal because that is the most common mascot to have in women’s college soccer. We sorted the mascots into categories: animal, mythical, people, nature, and miscellaneous. Though we had some trouble with categorizing (an issue was that Georgetown’s mascot is officially a Hoya, whereas their mascot on every scrap of merchandise is a bulldog), we were able to sort accordingly. Another problem we had was that JMU’s mascot is a duke (dog) whereas Duquesne is a duke (person of high class in a royal sense). So despite some minor differences, we sorted the groups accordingly. It would be interesting to see how different mascots do against each other, like do animals typically beat mythical creatures, etc. 

It's worth nothing that teams from nature based names actually do better in some of these fields. However, we would need to look further at which teams may be doing very well who are just in that category.

```{r}

# If you're going to go down this road, then you absolutely should answer the matchup question (how well to animals do vs people, etc). Same for identical mascot name matchups - how often do they occur? You should get really creative here.

team_sums <- all_teams %>%
  group_by(institution, conference) %>% 
  summarize(
    tot_goals = sum(goals),
    tot_shutouts = sum(shutouts),
    tot_fouls = sum(fouls)
  ) %>% 
  distinct(institution, .keep_all = TRUE)

regex_unis <- regex(paste(unique(all_teams$institution), collapse = "|"))
regex_peoplemascot <- regex("governors|braves|mountaineers|duke|knights|matadors|chippewas|buccaneers|49ers|vikings|raiders|flyers|pioneers|pirates|islanders|colonels|seminoles|paladins|colonials|crusaders|vandals|explorers|trojans|techsters|jaspers|minutewomen|cowgirls|warriors|spartans|racers|highlanders|midshipmen|cornhuskers|huskers|lumberjacks|norse|irish|rebels|quakers|pilots|friars|boilermakers|royals|ladyjacks|aztecs|toreros|dons|saints|hatters|texas|volunteers|cadets|gauchos|miners|vaqueros|trailblazers|cadets|commodores|cavaliers|musketeers|lancer|gael|beacon")

mascot_list <- match_all %>% 
  mutate(institution = str_extract(team, regex_unis)) %>% 
  ## Asked CHATGPT: "How do I extract everything after a certain pattern in R?"
  mutate(mascot = str_squish(sub(regex_unis, "", team))) %>% 
  mutate(institution = case_when(
    str_detect(team, "LMU \\(CA\\)")~"LMU (CA)",
    str_detect(team, "Miami \\(FL\\)")~"Miami (FL)",
    str_detect(team, "Miami \\(OH\\)")~"Miami (OH)",
    str_detect(team, "Queens \\(NC\\)")~"Queens (NC)",
    str_detect(team, "Saint Francis \\(PA\\)")~"Saint Francis (PA)",
    str_detect(team, "Saint Mary's \\(CA\\)")~"Saint Mary's (CA)",
    str_detect(team, "St. John's \\(NY\\)")~"St. John's (NY)",
    str_detect(team, "St. Thomas \\(MN\\)")~"St. Thomas (MN)",
    str_detect(team, "FDU")~"Fairleigh Dickinson",
    TRUE~institution
  )) %>% 
  group_by(team, mascot, institution) %>% 
  summarize(
    tot_yc = sum(yellow_cards)
  ) %>% 
  inner_join(team_sums, by = "institution") %>% 
  mutate(mas_category = case_when(
    str_detect(str_to_lower(mascot), "devil|titan|griffin|demon|dragon|phoenix|billiken|blazer|triton")~"mythical",
    str_detect(str_to_lower(mascot), regex_peoplemascot)~"people",
    str_detect(str_to_lower(institution), "vmi")~"people",
    str_detect(str_to_lower(mascot), "tide|cyclones|sycamores|flame|beach|hurricane|buckeyes|waves|storm|orange")~"nature",
    str_detect(str_to_lower(mascot), "big red|big green|purple aces|crimson|pride|illini|cajuns|ramblers|mean green|blue hose|red flash|rockets|lady topper|tribe")~"miscellaneous",
    TRUE~"animal"
  )) %>% 
  replace(is.na(.), 0) 

by_mascot <- mascot_list %>% 
  group_by(mas_category) %>% 
  summarize(
    mean_fouls = mean(tot_fouls),
    med_fouls = median(tot_fouls),
    mean_goals = mean(tot_goals),
    med_goals = median(tot_goals),
    med_shut = median(tot_shutouts)
  )

boxplot(mascot_list$tot_goals ~ mascot_list$mas_category)
boxplot(mascot_list$tot_shutouts ~ mascot_list$mas_category)

```

## Caveats and Limitations:
- Some statistics in 2020 are not present in 2021 and 2022, and vice versa
- We do not have data about the teams as a whole (i.e. what division they are in, what conference they are in)
- 2020 had only some conferences playing matches since it was during COVID, also fewer players so some may have redshirted, opted-out, etc.
- Matches are not classified at playoff games or normal games, so we would need to check the dates.
- No game count or shots on goal data for 2020 players, not sure if this was a scrape problem or something else.


